<@messages errors=errors />
<@messages infos=infos />
<#include "include/popins.html">
<#include "include/certificate.html">
<#include "include/franceconnect.html">

<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12">
        <div class="box box-primary">
            <div class="box-header">
                <h3 class="box-title">#i18n{module.mydashboard.identity.component.checkidentity.description}</h3>
            </div>
            <div class="box-body">
                <#if mandatory_informations_saved>
              	 	<div class="alert alert-primary" role="alert">
 						#i18n{module.mydashboard.identity.xpage.check_identity.messageInformationsCompletedSuccessfuly}
					 </div>
					   <#if service_url?? >
						     <a href="${service_url}" class="btn btn-primary">#i18n{module.mydashboard.identity.xpage.check_identity.labelBackToService} ${service_name!'#i18n{module.mydashboard.identity.xpage.check_identity.labelBackToService.default}'}</a>
						<#else>
						     <a href="jsp/site/Portal.jsp?page=mydashboardIdentity&action=viewIdentity" class="btn btn-primary">#i18n{module.mydashboard.identity.xpage.check_identity.labelBackToService} ${service_name!'#i18n{module.mydashboard.identity.xpage.check_identity.labelBackToService.default}'}</a>
						</#if>
				<#else>
               
                	<form class="form-horizontal" method="post" action="jsp/site/Portal.jsp?page=mydashboardIdentity&action=doCheckIdentity">
                
                        <input type="hidden" id="customerId" name="customerId" value="${identity.customerId.value!''}" />
                        <input type="hidden" id="connectionId" name="connectionId" value="${identity.connectionId.value!''}" />       
                        <div class="col-xs-12 col-sm-5 col-sm-offset-1">
                            <div class="form-group">
                                <i class="fa fa-user fa-5x" aria-hidden="true"></i>
                            </div>
                            <h4 class="box-title form-group">#i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.label}</h4>
                            
                            <#if identity.gender.mandatory>
	                            <div class="form-group">
	                                <label class="control-label" for="gender" >#i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelGenre} :</label>
	                                  <@comboWithParams name="gender" default_value="${identity.gender.value!}" additionalParameters=" id=\"gender\"  class=\"form-control\" " items=genderlist  />
	                                  <@certificate identity.gender />  
	                            </div>
	                        </#if>
	                        <#if identity.preferredUsername.mandatory>
		                         <div class="form-group">
	                                <label for="preferredUsername" >#i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelName} :</label>
	                                <input class="form-control input-sm" type="text" id="preferredUsername" name="preferredUsername" value="${identity.preferredUsername.value!''}" >
	                            </div>
	                         </#if>   
							
							<#if identity.lastName.mandatory>
	                            <div class="form-group">
	                                <label for="lastName" >
	                                    #i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelBirthName} 
	                                </label>
	                                <input class="form-control input-sm" type="text" id="lastName" name="lastName" value="${identity.lastName.value!}"  >
	                                <@certificate identity.lastName />                           
	                            </div>
	                          </#if>  
							<#if identity.firstname.mandatory>
	                            <div class="form-group">
	                                <label class="control-label" for="firstname" >#i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelFirstName} :</label>
	                                <input class="form-control" type="text" id="firstname" name="firstname" value="${identity.firstname.value!}"   />
	                                <@certificate identity.firstname />  
	                            </div>
							</#if>
							<#if identity.birthdate.mandatory>	
                            	<div class="form-group">
                                	<label class="control-label" for="birthdate" >
                                   	 #i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelBirthdate} 
                               		 </label>
                                	<input class="form-control" type="text" id="birthdate" name="birthdate" value="${identity.birthdate.value!}"  />
                                 	<@certificate identity.birthdate />                      
                            	</div>
                            </#if>
                            <#if identity.birthplace.mandatory>		
	                            <div class="form-group">
	                                <label class="control-label" for="birthplace" >
	                                    #i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelBirthPlace}
	                                </label>
	                                <input class="form-control" type="text" id="birthplace" name="birthplace" value="${identity.birthplace.value!}"  />
	                                <@certificate identity.birthplace />
	                            </div>
                            </#if>
                              <#if identity.birthcountry.mandatory>	
	                            <div class="form-group">
	                                <label class="control-label" for="birthcountry" >
	                                    #i18n{module.mydashboard.identity.xpage.check_identity.generalinfo.labelBirthCountry}   
	                                </label>
	                                <input class="form-control" type="text" id="birthcountry" name="birthcountry" value="${identity.birthcountry.value!}"  />
	                                <@certificate identity.birthcountry />
	                            </div>
	                            <@displayFranceConnectCertifierButton identity/> 
	                          </#if>  
	                          
	                          
	                          
	                        </div>
	                        <div class="col-xs-12 col-sm-5 col-sm-offset-1">
                            <div>
                                <#if identity.address.mandatory>
	                                <h4 class="box-title form-group">#i18n{module.mydashboard.identity.xpage.check_identity.address.label}</h4>
	                                <div class="form-group">
	                                    <label class="control-label" for="address" >#i18n{module.mydashboard.identity.xpage.check_identity.address.labelAdress} :</label>
	                                    <input class="form-control" type="text" id="address" name="address" value="${identity.address.value!}"  />
	                                </div>
	                             </#if>
	                            <#if identity.addressDetail.mandatory>
	                                <div class="form-group">
	                                    <label class="control-label" for="address_detail" >#i18n{module.mydashboard.identity.xpage.check_identity.address.labelAdressDetail} :</label>
	                                    <input class="form-control" type="text" id="address_detail" name="address_detail" value="${identity.addressDetail.value!}"  />
	                                </div>
	                             </#if>
	                             <#if identity.addressPostalcode.mandatory>
	                                <div class="form-group">
	                                    <label class="control-label" for="address_postalcode" >#i18n{module.mydashboard.identity.xpage.check_identity.address.labelPostalCode} :</label>
	                                    <input class="form-control" type="text" id="address_postalcode" name="address_postalcode" value="${identity.addressPostalcode.value!}"  />
	                                </div>
	                             </#if>  
	                             <#if identity.addressCity.mandatory>
	                                <div class="form-group">
	                                    <label class="control-label" for="address_city" >#i18n{module.mydashboard.identity.xpage.check_identity.address.labelCity} :</label>
	                                    <input class="form-control" type="text" id="address_city" name="address_city" value="${identity.addressCity.value!}"  />
	                                </div>
	                              </#if>  
                            </div>
                            <div>
                                <br>
                                <h4 class="box-title form-group">#i18n{module.mydashboard.identity.xpage.check_identity.contact.label}</h4>
                                 <#if identity.email.mandatory>
		                                <div class="form-group">
		                                    <label class="control-label" for="email" >#i18n{module.mydashboard.identity.xpage.check_identity.contact.labelEmail} :</label>
		                                    <input class="form-control" type="text" id="email" name="email" value="${identity.email.value!}"  />
		                                </div>
                                </#if>
                                 <#if identity.mobilePhone.mandatory>
	                                <div class="form-group">
	                                    <label class="control-label" for="mobile_phone" >#i18n{module.mydashboard.identity.xpage.check_identity.contact.labelMobilePhone} :</label>
	                                    <input class="form-control" type="text" id="mobile_phone" name="mobile_phone" value="${identity.mobilePhone.value!}"  />
	                                    <@certificate identity.mobilePhone />
	                                </div>
                                </#if>
                                <#if identity.phone.mandatory>
	                                <div class="form-group">
	                                    <label class="control-label" for="phone" >#i18n{module.mydashboard.identity.xpage.check_identity.contact.labelPhone} :</label>
	                                    <input class="form-control" type="text" id="phone" name="phone" value="${identity.phone.value!}"  />
	                                </div>
	                            </#if>

                            </div>

                            <div>
                                <br>
                                <h4 class="box-title form-group">#i18n{module.mydashboard.identity.xpage.check_identity.authentication.label}</h4>
                                <div class="form-group">
                                    <label class="control-label" for="login" >#i18n{module.mydashboard.identity.xpage.check_identity.authentication.labelLogin} :</label>
                                    <input class="form-control" type="text" id="login" name="login" value="${identity.login.value!}" readonly />
                                </div>

                                <div class="form-group">
                                    <label class="control-label" for="password" >#i18n{module.mydashboard.identity.xpage.check_identity.authentication.labelPassword} :</label>
                                    <input class="form-control" type="password" id="password" name="password" value="password" readonly />
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn btn-small btn-primary"><i class="icon-ok icon-white">&nbsp;</i>&nbsp;#i18n{module.mydashboard.identity.xpage.check_identity.authentication.labelButtonModifyPassword}</button> 
                                    
                                </div>

                            </div>

                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12">
                                <div class="form-group text-center">
                                    
                                    <button type="submit" class="btn btn-small btn-primary"><i class="icon-ok icon-white">&nbsp;</i>&nbsp;#i18n{module.mydashboard.identity.xpage.check_identity.labelButtonValidate}</button> 
                                    <button class="btn btn-small" name="back" id="back" value="back" title="#i18n{portal.util.labelBack}">
                                        <i class="icon-remove-circle">&nbsp;</i>&nbsp;#i18n{module.mydashboard.identity.xpage.check_identity.labelButtonCancel}
                                    </button>
                                </div>
                            </div>
                        </div>					
                    </form>
                  </#if>	  
            </div>
        </div>
    </div>
</div>


<script type="text/javascript" src="jsp/site/plugins/address/modules/autocomplete/SetupSuggestPOI.js.jsp"></script>
<script type="text/javascript" src="js/plugins/address/modules/autocomplete/jQuery.suggestPOI.js"></script>
<script type="text/javascript" src="js/jquery/plugins/ui/jquery.ui.custom-autocomplete.min.js"></script>
<script type="text/javascript">

    //load css dynamically
    var loadresource = document.createElement('link');
    loadresource.setAttribute("rel", "stylesheet");
    loadresource.setAttribute("type", "text/css");
    loadresource.setAttribute("href", "js/jquery/plugins/ui/css/jquery-ui.css");
    document.getElementsByTagName("head")[0].appendChild(loadresource);

    $(window).load(function () {
        var jAdresse = $('#address');
        var jAdressePostalcode = $('#address_postalcode');
        var jAdresseCity = $('#address_city');
        jAdresse.suggestPOI();
        jAdresse.bind($.suggestPOI.EVT_SELECT, function (event) {
            //Use properties from BAN apiinput type. Would not work with suggestPOI.
            jAdresse.val(event.poi.sourcePOI.properties.name);
            jAdressePostalcode.val(event.poi.sourcePOI.properties.postcode);
            jAdresseCity.val(event.poi.sourcePOI.properties.city);
        });
    });
</script>

